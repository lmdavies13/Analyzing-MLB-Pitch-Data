<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analyzing MLB Pitch Trends</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Analyzing MLB Pitch Trends_v0407_files/libs/clipboard/clipboard.min.js"></script>
<script src="Analyzing MLB Pitch Trends_v0407_files/libs/quarto-html/quarto.js"></script>
<script src="Analyzing MLB Pitch Trends_v0407_files/libs/quarto-html/popper.min.js"></script>
<script src="Analyzing MLB Pitch Trends_v0407_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Analyzing MLB Pitch Trends_v0407_files/libs/quarto-html/anchor.min.js"></script>
<link href="Analyzing MLB Pitch Trends_v0407_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Analyzing MLB Pitch Trends_v0407_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Analyzing MLB Pitch Trends_v0407_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Analyzing MLB Pitch Trends_v0407_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Analyzing MLB Pitch Trends_v0407_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analyzing MLB Pitch Trends</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this project we will analyze MLB pitch data from 2015-2018 to view trends in pitching performance using statistical analysis, predictive modeling, and classification techniques. Our goal is to develop models that predict variables like pitch speed while also implementing classification models to determine pitch type.This project will involve data cleaning, visualization, and model evaluation.</p>
<p>We will be using a dataset published on Kaggle titled “MLB Pitch Data (2015-2018),” which contains 8 different tables with information on pitches, at-bats, games, and players. Our focus will primarily be on the “pitches” table, which includes 2,867,154 pitch observations with 40 different attributes describing various aspects of each pitch. While most of the features are continuous variables measuring aspects like speed and rotation, categorical features such as pitch type provide opportunities for classification modeling. The dataset contains noise, including outlier pitches, missing values, and irrelevant features, which will require preprocessing before analysis. By leveraging this data, we aim to build predictive models to analyze pitch characteristics and gain deeper insights into pitching trends.</p>
<section id="load-the-dataset-inspect-structure" class="level1">
<h1>1. Load the Dataset &amp; Inspect Structure</h1>
<section id="load-the-csv---first-install-any-packages-we-will-be-using" class="level2">
<h2 class="anchored" data-anchor-id="load-the-csv---first-install-any-packages-we-will-be-using">1.1 Load the CSV - First install any packages we will be using</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"corrplot"</span>, <span class="at">repos =</span> <span class="st">"https://cloud.r-project.org"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/kd/s1h8v45s00xf4p3dkpvv7ykc0000gn/T//RtmpYRjARr/downloaded_packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>, <span class="at">repos =</span> <span class="st">"https://cloud.r-project.org"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/kd/s1h8v45s00xf4p3dkpvv7ykc0000gn/T//RtmpYRjARr/downloaded_packages</code></pre>
</div>
</div>
<p>Load necessary libraries</p>
<p>Read the dataset (CSV Format)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_file <span class="ot">&lt;-</span> <span class="st">"pitches.csv"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>pitch_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(data_file)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2867154 Columns: 40
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (3): code, type, pitch_type
dbl (37): px, pz, start_speed, end_speed, spin_rate, spin_dir, break_angle, ...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
</section>
<section id="checking-structure-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="checking-structure-of-the-data">1.2 Checking Structure of the Data</h2>
<p>Check the structure of the dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(pitch_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,867,154
Columns: 40
$ px              &lt;dbl&gt; 0.416, -0.191, -0.518, -0.641, -1.821, 0.627, -1.088, …
$ pz              &lt;dbl&gt; 2.963, 2.347, 3.284, 1.221, 2.083, 2.397, 1.610, 2.047…
$ start_speed     &lt;dbl&gt; 92.9, 92.8, 94.1, 91.0, 75.4, 92.9, 93.3, 89.3, 92.1, …
$ end_speed       &lt;dbl&gt; 84.1, 84.1, 85.2, 84.0, 69.6, 84.8, 85.3, 82.4, 85.0, …
$ spin_rate       &lt;dbl&gt; 2305.052, 2689.935, 2647.972, 1289.590, 1374.569, 2743…
$ spin_dir        &lt;dbl&gt; 159.235, 151.402, 145.125, 169.751, 280.671, 148.110, …
$ break_angle     &lt;dbl&gt; -25.0, -40.7, -43.7, -1.3, 18.4, -45.7, -46.3, 7.3, -4…
$ break_length    &lt;dbl&gt; 3.2, 3.4, 3.7, 5.0, 12.0, 3.7, 3.6, 4.8, 4.0, 4.9, 4.8…
$ break_y         &lt;dbl&gt; 23.7, 23.7, 23.7, 23.8, 23.8, 23.7, 23.7, 23.8, 23.8, …
$ ax              &lt;dbl&gt; 7.665, 12.043, 14.368, 2.104, -10.280, 13.590, 14.549,…
$ ay              &lt;dbl&gt; 34.685, 34.225, 35.276, 28.354, 21.774, 32.274, 31.469…
$ az              &lt;dbl&gt; -11.960, -10.085, -11.560, -20.540, -34.111, -10.333, …
$ sz_bot          &lt;dbl&gt; 1.72, 1.72, 1.72, 1.74, 1.72, 1.72, 1.59, 1.59, 1.89, …
$ sz_top          &lt;dbl&gt; 3.56, 3.56, 3.56, 3.35, 3.56, 3.56, 3.45, 3.45, 3.46, …
$ type_confidence &lt;dbl&gt; 2.000, 2.000, 2.000, 2.000, 2.000, 2.000, 2.000, 0.778…
$ vx0             &lt;dbl&gt; -6.409, -8.411, -9.802, -8.071, -6.309, -6.943, -11.03…
$ vy0             &lt;dbl&gt; -136.065, -135.690, -137.668, -133.005, -110.409, -136…
$ vz0             &lt;dbl&gt; -3.995, -5.980, -3.337, -6.567, 0.325, -5.738, -7.762,…
$ x               &lt;dbl&gt; 101.1400, 124.2800, 136.7400, 109.6856, 146.5275, 118.…
$ x0              &lt;dbl&gt; 2.280, 2.119, 2.127, 2.279, 2.179, 2.273, 2.013, 2.298…
$ y               &lt;dbl&gt; 158.7800, 175.4100, 150.1100, 187.4635, 177.2428, 164.…
$ y0              &lt;dbl&gt; 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50…
$ z0              &lt;dbl&gt; 5.302, 5.307, 5.313, 5.210, 5.557, 5.264, 5.179, 5.284…
$ pfx_x           &lt;dbl&gt; 4.16, 6.57, 7.61, 1.17, -8.43, 7.32, 7.79, -0.77, 7.46…
$ pfx_z           &lt;dbl&gt; 10.93, 12.00, 10.88, 6.45, -1.65, 11.72, 11.97, 7.38, …
$ nasty           &lt;dbl&gt; 55, 31, 49, 41, 18, 42, 80, 39, 42, 34, 48, 40, 49, 45…
$ zone            &lt;dbl&gt; 3, 5, 1, 13, 13, 6, 13, 7, 14, 13, 13, 5, 11, 13, 13, …
$ code            &lt;chr&gt; "C", "S", "F", "B", "B", "X", "B", "D", "B", "B", "E",…
$ type            &lt;chr&gt; "S", "S", "S", "B", "B", "X", "B", "X", "B", "B", "X",…
$ pitch_type      &lt;chr&gt; "FF", "FF", "FF", "FF", "CU", "FF", "FF", "FC", "FF", …
$ event_num       &lt;dbl&gt; 3, 4, 5, 6, 7, 8, 12, 13, 17, 18, 19, 25, 26, 27, 31, …
$ b_score         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, …
$ ab_id           &lt;dbl&gt; 2.015e+09, 2.015e+09, 2.015e+09, 2.015e+09, 2.015e+09,…
$ b_count         &lt;dbl&gt; 0, 0, 0, 0, 1, 2, 0, 1, 0, 1, 2, 0, 0, 0, 0, 1, 1, 1, …
$ s_count         &lt;dbl&gt; 0, 1, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 1, 2, …
$ outs            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, …
$ pitch_num       &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 1, 2, 1, 2, 3, 1, 2, 3, 1, 2, 3, 4, …
$ on_1b           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, …
$ on_2b           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, …
$ on_3b           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</code></pre>
</div>
</div>
<p>Check for duplicates (if any)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pitch_df <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">duplicated</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>It appears that every single pitch observation is unique. This is due to the many different measurement attributes we have and the uniqueness of their values.</p>
<p>Print the size of the table</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pitch_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2867154      40</code></pre>
</div>
</div>
<p>Take a look at the features</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pitch_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [2,867,154 × 40] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ px             : num [1:2867154] 0.416 -0.191 -0.518 -0.641 -1.821 ...
 $ pz             : num [1:2867154] 2.96 2.35 3.28 1.22 2.08 ...
 $ start_speed    : num [1:2867154] 92.9 92.8 94.1 91 75.4 92.9 93.3 89.3 92.1 89.3 ...
 $ end_speed      : num [1:2867154] 84.1 84.1 85.2 84 69.6 84.8 85.3 82.4 85 82 ...
 $ spin_rate      : num [1:2867154] 2305 2690 2648 1290 1375 ...
 $ spin_dir       : num [1:2867154] 159 151 145 170 281 ...
 $ break_angle    : num [1:2867154] -25 -40.7 -43.7 -1.3 18.4 -45.7 -46.3 7.3 -45 2 ...
 $ break_length   : num [1:2867154] 3.2 3.4 3.7 5 12 3.7 3.6 4.8 4 4.9 ...
 $ break_y        : num [1:2867154] 23.7 23.7 23.7 23.8 23.8 23.7 23.7 23.8 23.8 23.8 ...
 $ ax             : num [1:2867154] 7.67 12.04 14.37 2.1 -10.28 ...
 $ ay             : num [1:2867154] 34.7 34.2 35.3 28.4 21.8 ...
 $ az             : num [1:2867154] -12 -10.1 -11.6 -20.5 -34.1 ...
 $ sz_bot         : num [1:2867154] 1.72 1.72 1.72 1.74 1.72 1.72 1.59 1.59 1.89 1.81 ...
 $ sz_top         : num [1:2867154] 3.56 3.56 3.56 3.35 3.56 3.56 3.45 3.45 3.46 3.52 ...
 $ type_confidence: num [1:2867154] 2 2 2 2 2 2 2 0.778 2 0.648 ...
 $ vx0            : num [1:2867154] -6.41 -8.41 -9.8 -8.07 -6.31 ...
 $ vy0            : num [1:2867154] -136 -136 -138 -133 -110 ...
 $ vz0            : num [1:2867154] -3.995 -5.98 -3.337 -6.567 0.325 ...
 $ x              : num [1:2867154] 101 124 137 110 147 ...
 $ x0             : num [1:2867154] 2.28 2.12 2.13 2.28 2.18 ...
 $ y              : num [1:2867154] 159 175 150 187 177 ...
 $ y0             : num [1:2867154] 50 50 50 50 50 50 50 50 50 50 ...
 $ z0             : num [1:2867154] 5.3 5.31 5.31 5.21 5.56 ...
 $ pfx_x          : num [1:2867154] 4.16 6.57 7.61 1.17 -8.43 7.32 7.79 -0.77 7.46 0.71 ...
 $ pfx_z          : num [1:2867154] 10.93 12 10.88 6.45 -1.65 ...
 $ nasty          : num [1:2867154] 55 31 49 41 18 42 80 39 42 34 ...
 $ zone           : num [1:2867154] 3 5 1 13 13 6 13 7 14 13 ...
 $ code           : chr [1:2867154] "C" "S" "F" "B" ...
 $ type           : chr [1:2867154] "S" "S" "S" "B" ...
 $ pitch_type     : chr [1:2867154] "FF" "FF" "FF" "FF" ...
 $ event_num      : num [1:2867154] 3 4 5 6 7 8 12 13 17 18 ...
 $ b_score        : num [1:2867154] 0 0 0 0 0 0 0 0 0 0 ...
 $ ab_id          : num [1:2867154] 2.02e+09 2.02e+09 2.02e+09 2.02e+09 2.02e+09 ...
 $ b_count        : num [1:2867154] 0 0 0 0 1 2 0 1 0 1 ...
 $ s_count        : num [1:2867154] 0 1 2 2 2 2 0 0 0 0 ...
 $ outs           : num [1:2867154] 0 0 0 0 0 0 1 1 1 1 ...
 $ pitch_num      : num [1:2867154] 1 2 3 4 5 6 1 2 1 2 ...
 $ on_1b          : num [1:2867154] 0 0 0 0 0 0 0 0 0 0 ...
 $ on_2b          : num [1:2867154] 0 0 0 0 0 0 0 0 1 1 ...
 $ on_3b          : num [1:2867154] 0 0 0 0 0 0 0 0 0 0 ...
 - attr(*, "spec")=
  .. cols(
  ..   px = col_double(),
  ..   pz = col_double(),
  ..   start_speed = col_double(),
  ..   end_speed = col_double(),
  ..   spin_rate = col_double(),
  ..   spin_dir = col_double(),
  ..   break_angle = col_double(),
  ..   break_length = col_double(),
  ..   break_y = col_double(),
  ..   ax = col_double(),
  ..   ay = col_double(),
  ..   az = col_double(),
  ..   sz_bot = col_double(),
  ..   sz_top = col_double(),
  ..   type_confidence = col_double(),
  ..   vx0 = col_double(),
  ..   vy0 = col_double(),
  ..   vz0 = col_double(),
  ..   x = col_double(),
  ..   x0 = col_double(),
  ..   y = col_double(),
  ..   y0 = col_double(),
  ..   z0 = col_double(),
  ..   pfx_x = col_double(),
  ..   pfx_z = col_double(),
  ..   nasty = col_double(),
  ..   zone = col_double(),
  ..   code = col_character(),
  ..   type = col_character(),
  ..   pitch_type = col_character(),
  ..   event_num = col_double(),
  ..   b_score = col_double(),
  ..   ab_id = col_double(),
  ..   b_count = col_double(),
  ..   s_count = col_double(),
  ..   outs = col_double(),
  ..   pitch_num = col_double(),
  ..   on_1b = col_double(),
  ..   on_2b = col_double(),
  ..   on_3b = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>From this we can see out of the 40 attributes, 37 of them are continuous, and 3 of them are categorical (code, type, pitch type)</p>
<p>Now we will look at the summary of the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pitch_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       px                pz          start_speed       end_speed    
 Min.   :-10.543   Min.   :-5.184   Min.   : 33.90   Min.   :32.40  
 1st Qu.: -0.591   1st Qu.: 1.650   1st Qu.: 84.30   1st Qu.:77.90  
 Median :  0.013   Median : 2.259   Median : 89.70   Median :82.50  
 Mean   :  0.007   Mean   : 2.255   Mean   : 88.38   Mean   :81.36  
 3rd Qu.:  0.609   3rd Qu.: 2.863   3rd Qu.: 93.00   3rd Qu.:85.40  
 Max.   : 12.953   Max.   :14.886   Max.   :105.00   Max.   :96.90  
 NA's   :14189     NA's   :14189    NA's   :14114    NA's   :14114  
   spin_rate           spin_dir        break_angle       break_length     
 Min.   :   1.214   Min.   : -0.002   Min.   :-90.000   Min.   :     0.1  
 1st Qu.:1238.745   1st Qu.:137.154   1st Qu.:-11.900   1st Qu.:     4.3  
 Median :1866.322   Median :195.885   Median :  6.800   Median :     6.0  
 Mean   :1731.173   Mean   :180.231   Mean   :  5.848   Mean   :     6.6  
 3rd Qu.:2247.564   3rd Qu.:225.234   3rd Qu.: 27.000   3rd Qu.:     8.0  
 Max.   :6539.259   Max.   :360.001   Max.   :269.400   Max.   :224889.3  
 NA's   :14189      NA's   :14189     NA's   :14189     NA's   :14189     
    break_y            ax                ay               az        
 Min.   :23.30   Min.   :-59.290   Min.   :-0.524   Min.   :-77.17  
 1st Qu.:23.80   1st Qu.:-11.290   1st Qu.:23.460   1st Qu.:-28.72  
 Median :23.80   Median : -3.142   Median :26.474   Median :-21.59  
 Mean   :23.82   Mean   : -2.309   Mean   :26.492   Mean   :-22.78  
 3rd Qu.:23.90   3rd Qu.:  5.996   3rd Qu.:29.384   3rd Qu.:-15.74  
 Max.   :36.40   Max.   : 40.978   Max.   :54.057   Max.   : 22.30  
 NA's   :14189   NA's   :14189     NA's   :14189    NA's   :14189   
     sz_bot           sz_top       type_confidence      vx0         
 Min.   :-7.921   Min.   :-1.849   Min.   :0.000   Min.   :-24.869  
 1st Qu.: 1.485   1st Qu.: 3.300   1st Qu.:0.906   1st Qu.: -2.082  
 Median : 1.570   Median : 3.440   Median :2.000   Median :  3.989  
 Mean   : 1.567   Mean   : 3.436   Mean   :1.551   Mean   :  2.283  
 3rd Qu.: 1.659   3rd Qu.: 3.579   3rd Qu.:2.000   3rd Qu.:  6.626  
 Max.   :10.698   Max.   :10.548   Max.   :2.000   Max.   : 25.150  
 NA's   :2083     NA's   :2083     NA's   :14189   NA's   :14189    
      vy0               vz0                x                x0        
 Min.   :-153.36   Min.   :-19.771   Min.   :  0.00   Min.   :-9.556  
 1st Qu.:-135.51   1st Qu.: -6.513   1st Qu.: 93.42   1st Qu.:-1.955  
 Median :-130.83   Median : -4.605   Median :116.14   Median :-1.334  
 Mean   :-128.86   Mean   : -4.421   Mean   :116.00   Mean   :-0.719  
 3rd Qu.:-122.94   3rd Qu.: -2.488   3rd Qu.:139.24   3rd Qu.: 0.777  
 Max.   : -47.55   Max.   : 27.815   Max.   :249.95   Max.   : 9.676  
 NA's   :14189     NA's   :14189                      NA's   :14189   
       y               y0              z0             pfx_x        
 Min.   :  0.0   Min.   :50      Min.   :-1.941   Min.   :-28.092  
 1st Qu.:160.7   1st Qu.:50      1st Qu.: 5.564   1st Qu.: -6.450  
 Median :177.2   Median :50      Median : 5.842   Median : -1.880  
 Mean   :175.9   Mean   :50      Mean   : 5.814   Mean   : -1.140  
 3rd Qu.:193.6   3rd Qu.:50      3rd Qu.: 6.105   3rd Qu.:  3.865  
 Max.   :250.0   Max.   :50      Max.   :10.596   Max.   : 22.020  
                 NA's   :14189   NA's   :14189    NA's   :14142    
     pfx_z             nasty             zone           code          
 Min.   :-70.206   Min.   :  0.00   Min.   : 1.00   Length:2867154    
 1st Qu.:  2.160   1st Qu.: 32.00   1st Qu.: 6.00   Class :character  
 Median :  6.090   Median : 44.00   Median :11.00   Mode  :character  
 Mean   :  5.046   Mean   : 44.43   Mean   : 9.82                     
 3rd Qu.:  8.950   3rd Qu.: 56.00   3rd Qu.:13.00                     
 Max.   : 33.160   Max.   :100.00   Max.   :14.00                     
 NA's   :14142     NA's   :14189    NA's   :14189                     
     type            pitch_type          event_num       b_score      
 Length:2867154     Length:2867154     Min.   :   3   Min.   : 0.000  
 Class :character   Class :character   1st Qu.: 149   1st Qu.: 0.000  
 Mode  :character   Mode  :character   Median : 302   Median : 1.000  
                                       Mean   : 313   Mean   : 2.257  
                                       3rd Qu.: 464   3rd Qu.: 3.000  
                                       Max.   :1336   Max.   :25.000  
                                                                      
     ab_id              b_count          s_count            outs       
 Min.   :2.015e+09   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:2.016e+09   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  
 Median :2.017e+09   Median :1.0000   Median :1.0000   Median :1.0000  
 Mean   :2.017e+09   Mean   :0.8824   Mean   :0.8811   Mean   :0.9826  
 3rd Qu.:2.018e+09   3rd Qu.:2.0000   3rd Qu.:2.0000   3rd Qu.:2.0000  
 Max.   :2.018e+09   Max.   :4.0000   Max.   :2.0000   Max.   :2.0000  
                                                                       
   pitch_num          on_1b            on_2b           on_3b        
 Min.   : 1.000   Min.   :0.0000   Min.   :0.000   Min.   :0.00000  
 1st Qu.: 1.000   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:0.00000  
 Median : 3.000   Median :0.0000   Median :0.000   Median :0.00000  
 Mean   : 2.894   Mean   :0.3018   Mean   :0.186   Mean   :0.09596  
 3rd Qu.: 4.000   3rd Qu.:1.0000   3rd Qu.:0.000   3rd Qu.:0.00000  
 Max.   :21.000   Max.   :1.0000   Max.   :1.000   Max.   :1.00000  
                                                                    </code></pre>
</div>
</div>
</section>
</section>
<section id="handling-nas" class="level1">
<h1>2. Handling NAs</h1>
<section id="first-remove-attributes-we-dont-need" class="level2">
<h2 class="anchored" data-anchor-id="first-remove-attributes-we-dont-need">2.1 First, Remove Attributes we don’t need</h2>
<p>Below we will remove the following attributes as they will serve us no purpose in our analysis.</p>
<p>px - We are not concerned with the location on home plate, we have Zone</p>
<p>pz - We are not concerned with the location on home plate, we have Zone</p>
<p>break_y - we have break angle and break length</p>
<p>ax - Raw acceleration vector - dont need for analysis</p>
<p>ay - Raw acceleration vector - dont need for analysis</p>
<p>az - Raw acceleration vector - dont need for analysis</p>
<p>sz_bot - Not really concerned with batter specifics</p>
<p>sz_top - Not really concerned with batter specifics</p>
<p>type_confidence - Don’t really care about pitch classification quality</p>
<p>event_num - Not concerned with game or score specifics</p>
<p>b_score - Not concerned with game or score specifics</p>
<p>ab_id - Not concerned with who is at bat</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># listing the columns to remove</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cols_to_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"px"</span>, <span class="st">"pz"</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"break_y"</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ax"</span>, <span class="st">"ay"</span>, <span class="st">"az"</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sz_bot"</span>, <span class="st">"sz_top"</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"type_confidence"</span>, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"event_num"</span>, <span class="st">"b_score"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ab_id"</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#replace pitch_df to exclude the above columns</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>pitch_df <span class="ot">&lt;-</span> pitch_df[, <span class="sc">!</span>(<span class="fu">names</span>(pitch_df) <span class="sc">%in%</span> cols_to_remove)]</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">#print out the new df attributes</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Remaining columns in pitch_df:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Remaining columns in pitch_df:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(pitch_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "start_speed"  "end_speed"    "spin_rate"    "spin_dir"     "break_angle" 
 [6] "break_length" "vx0"          "vy0"          "vz0"          "x"           
[11] "x0"           "y"            "y0"           "z0"           "pfx_x"       
[16] "pfx_z"        "nasty"        "zone"         "code"         "type"        
[21] "pitch_type"   "b_count"      "s_count"      "outs"         "pitch_num"   
[26] "on_1b"        "on_2b"        "on_3b"       </code></pre>
</div>
</div>
</section>
<section id="removing-nas" class="level2">
<h2 class="anchored" data-anchor-id="removing-nas">2.2 Removing NAs</h2>
<p>Check for missing values: find the NA’s in each column</p>
<p>Check the number of NAs in each column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check for missing values</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(pitch_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> start_speed    end_speed    spin_rate     spin_dir  break_angle break_length 
       14114        14114        14189        14189        14189        14189 
         vx0          vy0          vz0            x           x0            y 
       14189        14189        14189            0        14189            0 
          y0           z0        pfx_x        pfx_z        nasty         zone 
       14189        14189        14142        14142        14189        14189 
        code         type   pitch_type      b_count      s_count         outs 
        5719            0        14189            0            0            0 
   pitch_num        on_1b        on_2b        on_3b 
           0            0            0            0 </code></pre>
</div>
</div>
<p>Lets look and see what the percentage of NAs is per column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for the percentage of missing values </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(<span class="fu">is.na</span>(pitch_df)) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> start_speed    end_speed    spin_rate     spin_dir  break_angle break_length 
   0.4922652    0.4922652    0.4948810    0.4948810    0.4948810    0.4948810 
         vx0          vy0          vz0            x           x0            y 
   0.4948810    0.4948810    0.4948810    0.0000000    0.4948810    0.0000000 
          y0           z0        pfx_x        pfx_z        nasty         zone 
   0.4948810    0.4948810    0.4932417    0.4932417    0.4948810    0.4948810 
        code         type   pitch_type      b_count      s_count         outs 
   0.1994661    0.0000000    0.4948810    0.0000000    0.0000000    0.0000000 
   pitch_num        on_1b        on_2b        on_3b 
   0.0000000    0.0000000    0.0000000    0.0000000 </code></pre>
</div>
</div>
<section id="deciding-how-to-handle-these" class="level3">
<h3 class="anchored" data-anchor-id="deciding-how-to-handle-these">Deciding how to handle these:</h3>
<p>Due to the percentage of missing values being so small in the dataset, we will just remove them all without further investigation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>na_rows <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">is.na</span>(pitch_df), <span class="dv">1</span>, any)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>pitch_df <span class="ot">&lt;-</span> pitch_df[<span class="sc">!</span>na_rows, ]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(pitch_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="lets-look-at-any-infinite-values" class="level3">
<h3 class="anchored" data-anchor-id="lets-look-at-any-infinite-values">Lets look at any infinite values</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check how many rows contain any infinite values</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>infinite_rows <span class="ot">&lt;-</span> <span class="fu">apply</span>(pitch_df, <span class="dv">1</span>, <span class="cf">function</span>(row) <span class="fu">any</span>(<span class="fu">is.infinite</span>(row)))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows with Inf or -Inf values:"</span>, <span class="fu">sum</span>(infinite_rows), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows with Inf or -Inf values: 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove those rows</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>pitch_df <span class="ot">&lt;-</span> pitch_df[<span class="sc">!</span>infinite_rows, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="new-dimension-of-df" class="level3">
<h3 class="anchored" data-anchor-id="new-dimension-of-df">New Dimension of DF</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pitch_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2847250      28</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="looking-at-our-variables" class="level1">
<h1>3. Looking at our Variables</h1>
<section id="variable-descriptions-pitches.csv" class="level3">
<h3 class="anchored" data-anchor-id="variable-descriptions-pitches.csv"><strong>Variable Descriptions – <code>pitches.csv</code></strong></h3>
<ul>
<li><p><strong>start_speed</strong>: Speed of the pitch at release (in mph).</p></li>
<li><p><strong>end_speed</strong>: Speed of the pitch when it crosses the plate (in mph).</p></li>
<li><p><strong>spin_rate</strong>: Rate of spin on the ball (in revolutions per minute).</p></li>
<li><p><strong>spin_dir</strong>: Direction of spin measured in degrees (like a clock face).</p></li>
<li><p><strong>break_angle</strong>: Horizontal angle of the pitch’s break (in degrees).</p></li>
<li><p><strong>break_length</strong>: Magnitude of the pitch’s break (in inches).</p></li>
<li><p><strong>vx0, vy0, vz0</strong>: Velocity components at the release point in the x, y, and z directions (in ft/sec).</p></li>
<li><p><strong>x, y</strong>: Plate location coordinates (pixels in original video context, less relevant for analysis).</p></li>
<li><p><strong>x0, y0, z0</strong>: Release point coordinates of the pitch (in feet).</p></li>
<li><p><strong>pfx_x, pfx_z</strong>: Pitch movement in the x and z directions due to spin (in inches).</p></li>
<li><p><strong>nasty</strong>: A subjective rating of how difficult the pitch is to hit (higher is harder).</p></li>
<li><p><strong>zone</strong>: Zone number representing where the pitch crossed the strike zone.</p></li>
<li><p><strong>code</strong>: Umpire’s call (e.g., ‘B’ = ball, ‘C’ = called strike, ‘S’ = swinging strike).</p></li>
<li><p><strong>type</strong>: Simplified pitch result (e.g., ‘S’ = strike, ‘B’ = ball).</p></li>
<li><p><strong>pitch_type</strong>: Type of pitch (e.g., ‘FF’ = four-seam fastball, ‘SL’ = slider).</p></li>
<li><p><strong>b_count, s_count</strong>: Number of balls and strikes at the time of the pitch.</p></li>
<li><p><strong>outs</strong>: Number of outs in the inning.</p></li>
<li><p><strong>pitch_num</strong>: Pitch number in the current at-bat.</p></li>
<li><p><strong>on_1b, on_2b, on_3b</strong>: Binary indicators (0 or 1) for whether there was a runner on first, second, or third base.</p></li>
</ul>
</section>
<section id="looking-at-categorical" class="level2">
<h2 class="anchored" data-anchor-id="looking-at-categorical">3.1 Looking at Categorical</h2>
<section id="pitch-types" class="level3">
<h3 class="anchored" data-anchor-id="pitch-types">Pitch Types</h3>
<p>CH - Changeup</p>
<p>CU - Curveball</p>
<p>EP - Eephus*</p>
<p>FC - Cutter</p>
<p>FF - Four-seam Fastball</p>
<p>FO - Pitchout (also PO)*</p>
<p>FS - Splitter</p>
<p>FT - Two-seam Fastball</p>
<p>IN - Intentional ball</p>
<p>KC - Knuckle curve</p>
<p>KN - Knuckeball</p>
<p>PO - Pitchout (also FO)*</p>
<p>SC - Screwball*</p>
<p>SI - Sinker</p>
<p>SL - Slider</p>
<p>UN - Unknown*</p>
<ul>
<li>these pitch types occur rarely</li>
</ul>
</section>
<section id="type" class="level3">
<h3 class="anchored" data-anchor-id="type">Type</h3>
<ul>
<li><p><strong>B</strong> = <strong>Ball</strong></p></li>
<li><p><strong>S</strong> = <strong>Strike</strong></p></li>
<li><p><strong>X</strong> = <strong>In play</strong></p></li>
</ul>
</section>
<section id="code-type" class="level3">
<h3 class="anchored" data-anchor-id="code-type">Code Type</h3>
<p>While these aren’t spelled out anywhere, play descriptions allowed confident identification of these codes</p>
<p>B - Ball</p>
<p>*B - Ball in dirt</p>
<p>S - Swinging Strike</p>
<p>C - Called Strike</p>
<p>F - Foul</p>
<p>T - Foul Tip</p>
<p>L - Foul Bunt</p>
<p>I - Intentional Ball</p>
<p>W - Swinging Strike (Blocked)</p>
<p>M - Missed Bunt</p>
<p>P - Pitchout</p>
<p>Q - Swinging pitchout</p>
<p>R - Foul pitchout</p>
<p>Values that only occur on last pitch of at-bat:</p>
<p>X - In play, out(s)</p>
<p>D - In play, no out</p>
<p>E - In play, runs</p>
<p>H - Hit by pitch</p>
<p>Note: all codes, except for H, come directly from the XML files. All at-bats with code H were given no code in the XMLs.</p>
</section>
<section id="categorical-distribution" class="level3">
<h3 class="anchored" data-anchor-id="categorical-distribution">Categorical Distribution</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Categorical variables</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>cat_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"code"</span>, <span class="st">"type"</span>, <span class="st">"pitch_type"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Boolean/binary runner flags</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>runner_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"on_1b"</span>, <span class="st">"on_2b"</span>, <span class="st">"on_3b"</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Numeric discrete variables (should be treated like categorical)</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>num_discrete <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"b_count"</span>, <span class="st">"s_count"</span>, <span class="st">"outs"</span>, <span class="st">"zone"</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency tables for categorical vars</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Frequency tables for categorical variables:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Frequency tables for categorical variables:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> cat_vars) {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, var, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(pitch_df[[var]]))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 code :

    *B      B      C      D      E      F      H      I      L      M      P 
 65538 954229 479654 116795  64038 495293   6925   6207   8427   1839    617 
     Q      R      S      T      V      W      X      Z 
     6      2 270656  23890      9  23097 330027      1 

 type :

      B       S       X 
1033525 1302864  510861 

 pitch_type :

     AB      CH      CU      EP      FA      FC      FF      FO      FS      FT 
      9  292123  233913     812       9  149376 1012917     810   43533  337244 
     IN      KC      KN      PO      SC      SI      SL      UN 
   6187   66410   11260     626     113  242047  449804      57 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions for each categorical var</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proportion tables:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Proportion tables:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> cat_vars) {</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, var, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(pitch_df[[var]])))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 code :

          *B            B            C            D            E            F 
2.301800e-02 3.351406e-01 1.684622e-01 4.102028e-02 2.249118e-02 1.739549e-01 
           H            I            L            M            P            Q 
2.432171e-03 2.179998e-03 2.959698e-03 6.458864e-04 2.167003e-04 2.107297e-06 
           R            S            T            V            W            X 
7.024322e-07 9.505874e-02 8.390552e-03 3.160945e-06 8.112038e-03 1.159108e-01 
           Z 
3.512161e-07 

 type :

        B         S         X 
0.3629906 0.4575868 0.1794226 

 pitch_type :

          AB           CH           CU           EP           FA           FC 
3.160945e-06 1.025983e-01 8.215401e-02 2.851875e-04 3.160945e-06 5.246325e-02 
          FF           FO           FS           FT           IN           KC 
3.557527e-01 2.844850e-04 1.528949e-02 1.184455e-01 2.172974e-03 2.332426e-02 
          KN           PO           SC           SI           SL           UN 
3.954693e-03 2.198613e-04 3.968742e-05 8.501080e-02 1.579784e-01 2.001932e-05 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency tables for runner presence</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Runner presence (boolean) counts:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Runner presence (boolean) counts:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> runner_vars) {</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, var, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(pitch_df[[var]]))</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 on_1b :

      0       1 
1985895  861355 

 on_2b :

      0       1 
2321727  525523 

 on_3b :

      0       1 
2577102  270148 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency tables for numeric discrete (but categorical in logic)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Frequency tables for numeric discrete (treated as categorical):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Frequency tables for numeric discrete (treated as categorical):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> num_discrete) {</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, var, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(pitch_df[[var]]))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 b_count :

      0       1       2       3       4 
1284558  850191  480031  232457      13 

 s_count :

      0       1       2 
1154897  870306  822047 

 outs :

     0      1      2 
978637 943453 925160 

 zone :

     1      2      3      4      5      6      7      8      9     11     12 
 94510 103921  86543 140545 158059 139779 123851 144567 135437 364903 271201 
    13     14 
480398 603536 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plots for all: categorical + boolean + discrete</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>all_cat_like_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(cat_vars, runner_vars, num_discrete)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> all_cat_like_vars) {</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(pitch_df, <span class="fu">aes_string</span>(<span class="at">x =</span> var)) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Distribution of"</span>, var), <span class="at">x =</span> var, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="ot">-&gt;</span> p</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-14-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-14-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-14-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-14-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-14-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-14-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-14-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="looking-at-continuous" class="level2">
<h2 class="anchored" data-anchor-id="looking-at-continuous">3.2 Looking at Continuous</h2>
<section id="looking-at-continuous-distributions" class="level3">
<h3 class="anchored" data-anchor-id="looking-at-continuous-distributions">Looking at Continuous Distributions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define all non-continuous variables (categorical + boolean + discrete)</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>non_cont <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"code"</span>, <span class="st">"type"</span>, <span class="st">"pitch_type"</span>, </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">"on_1b"</span>, <span class="st">"on_2b"</span>, <span class="st">"on_3b"</span>, </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">"b_count"</span>, <span class="st">"s_count"</span>, <span class="st">"outs"</span>, <span class="st">"zone"</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get remaining variable names (candidate continuous)</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>cont_vars <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(pitch_df), non_cont)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only truly numeric continuous variables</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>cont_vars <span class="ot">&lt;-</span> cont_vars[<span class="fu">sapply</span>(pitch_df[cont_vars], is.numeric)]</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape to long format and remove non-finite values</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>pitch_df_long <span class="ot">&lt;-</span> pitch_df <span class="sc">%&gt;%</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(cont_vars)) <span class="sc">%&gt;%</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.finite</span>(value))</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot faceted density plots</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pitch_df_long, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Continuous Variables"</span>,</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm):
collapsing to unique 'x' values</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="correlation" class="level2">
<h2 class="anchored" data-anchor-id="correlation">3.3 Correlation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define non-continuous (categorical + discrete) variables</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>non_cont <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"code"</span>, <span class="st">"type"</span>, <span class="st">"pitch_type"</span>, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"on_1b"</span>, <span class="st">"on_2b"</span>, <span class="st">"on_3b"</span>, </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"b_count"</span>, <span class="st">"s_count"</span>, <span class="st">"outs"</span>, <span class="st">"zone"</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get continuous numeric variables</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>cont_vars <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(pitch_df), non_cont)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>cont_vars <span class="ot">&lt;-</span> cont_vars[<span class="fu">sapply</span>(pitch_df[cont_vars], is.numeric)]</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># remove variables with no variance</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>cont_vars <span class="ot">&lt;-</span> cont_vars[<span class="fu">sapply</span>(pitch_df[cont_vars], <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x)) <span class="sc">&gt;</span> <span class="dv">1</span>)]</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Build correlation matrix</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>cont_data <span class="ot">&lt;-</span> pitch_df[, cont_vars]</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>corr_mat <span class="ot">&lt;-</span> <span class="fu">cor</span>(cont_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)  <span class="co"># Handles any residual NAs safely</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot correlation matrix</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  corr_mat,</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"circle"</span>,</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">order =</span> <span class="st">"hclust"</span>,  <span class="co"># Group highly correlated variables</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>,  <span class="co"># Label text color</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.cex =</span> <span class="fl">0.7</span>,      <span class="co"># Label size</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.srt =</span> <span class="dv">45</span>,       <span class="co"># Label rotation</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"navy"</span>, <span class="st">"white"</span>, <span class="st">"firebrick3"</span>))(<span class="dv">200</span>)  <span class="co"># Custom color gradient</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="looking-at-outliers" class="level2">
<h2 class="anchored" data-anchor-id="looking-at-outliers">3.4 Looking at Outliers</h2>
<section id="boxplots-to-spot-outliers-in-continuous-vars" class="level3">
<h3 class="anchored" data-anchor-id="boxplots-to-spot-outliers-in-continuous-vars">Boxplots to spot outliers in continuous vars</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot faceted boxplots</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pitch_df_long, <span class="fu">aes</span>(<span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">outlier.color =</span> <span class="st">"red"</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplots of Continuous Variables"</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looking specifically at pitch speed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pitch_df, <span class="fu">aes</span>(<span class="at">y =</span> start_speed)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Pitch Speeds"</span>, <span class="at">y =</span> <span class="st">"Pitch Speed (mph)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="for-now-we-will-hold-off-on-normalizing-and-removing-outliers-until-we-begin-modeling" class="level3">
<h3 class="anchored" data-anchor-id="for-now-we-will-hold-off-on-normalizing-and-removing-outliers-until-we-begin-modeling">For now, we will hold off on normalizing and removing outliers until we begin modeling</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Detect outliers using IQR method</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Q1 &lt;- quantile(pitch_df$start_speed, 0.25, na.rm = TRUE)</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Q3 &lt;- quantile(pitch_df$start_speed, 0.75, na.rm = TRUE) IQR &lt;- #Q3 - Q1</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Define lower and upper bounds</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co">#lower_bound &lt;- Q1 - 1.5 * IQR upper_bound &lt;- Q3 + 1.5 * IQR</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter out extreme outliers</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co">#pitch_df_clean &lt;- pitch_df %&gt;% filter(start_speed &gt;= lower_bound &amp; start_speed &lt;= upper_bound)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="questions-we-want-answer" class="level1">
<h1>4. Questions we want answer</h1>
<section id="questions" class="level3">
<h3 class="anchored" data-anchor-id="questions">Questions</h3>
<ul>
<li><p>How does pitch speed vary across different pitch types?</p></li>
<li><p>How does spin rate affect pitch outcome?</p></li>
<li><p>Do certain pitches produce certain pitching events (des)?</p></li>
<li><p>What is the most common pitch types used in different situations?</p></li>
<li><p>Do certain pitch tpyes lead to more “nasty” pitches, and what features most influence nastiness?</p></li>
<li><p>Does pitch effectiveness vary when runners are on base?</p></li>
<li><p>How consistent are pitch characteristic within a pitch type?</p></li>
</ul>
</section>
<section id="target-variable" class="level3">
<h3 class="anchored" data-anchor-id="target-variable">Target Variable</h3>
<ul>
<li><p>start_speed (regression)</p></li>
<li><p>pitch_type (classification)</p></li>
<li><p>nasty/nasty_category (regression or classification)</p></li>
</ul>
</section>
<section id="predictor-variables" class="level3">
<h3 class="anchored" data-anchor-id="predictor-variables">Predictor Variables</h3>
<ul>
<li><p>spin_rate, spin_dir, break_angle, break_length</p></li>
<li><p>vx0, vy0, vz0 (initial velocity vectors)</p></li>
<li><p>pfx_x, pfx_z (movement due to spin)</p></li>
<li><p>x0, z0 (release point coords — maybe exclude <code>y0</code> as it’s uniform)</p></li>
<li><p>b_count, s_count, outs, zone</p></li>
<li><p>Engineered features: count_category, spin_compass, nasty_category, travel_time</p></li>
</ul>
</section>
</section>
<section id="exploratory-data-analysis-visualization-and-transformation" class="level1">
<h1>5. Exploratory Data Analysis, Visualization and Transformation</h1>
<section id="summary-stats-for-key-numeric-columns" class="level3">
<h3 class="anchored" data-anchor-id="summary-stats-for-key-numeric-columns">Summary Stats for Key Numeric Columns</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary Statistics for key numeric columns</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pitch_df<span class="sc">$</span>spin_rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
   1.214 1238.646 1866.259 1731.086 2247.466 6539.259 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pitch_df<span class="sc">$</span>start_speed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  33.90   84.30   89.70   88.38   93.00  105.00 </code></pre>
</div>
</div>
</section>
<section id="visualizations" class="level2">
<h2 class="anchored" data-anchor-id="visualizations">5.1 Visualizations</h2>
<section id="pitch-speed-distribution-by-pitch-type" class="level3">
<h3 class="anchored" data-anchor-id="pitch-speed-distribution-by-pitch-type">Pitch Speed Distribution by Pitch Type</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pitch_df, <span class="fu">aes</span>(<span class="at">x=</span>pitch_type, <span class="at">y=</span> start_speed)) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pitch Speed Distribution by Pitch Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distribution-of-pitch-types" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-pitch-types">Distribution of Pitch Types</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pitch_df, <span class="fu">aes</span>(<span class="at">x =</span> pitch_type)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frequency of Different Pitch Types"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distribution-of-pitch-speeds" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-pitch-speeds">Distribution of Pitch Speeds</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pitch_df, <span class="fu">aes</span>(<span class="at">x =</span> start_speed)) <span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density Plot of Pitch Speeds"</span>, <span class="at">x =</span> <span class="st">"Pitch Speed (mph)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histograms-for-pitch-speed-and-spin-rate" class="level3">
<h3 class="anchored" data-anchor-id="histograms-for-pitch-speed-and-spin-rate">Histograms for pitch speed, and spin rate</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pitch_df, <span class="fu">aes</span>(<span class="at">x =</span> start_speed)) <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Pitch Speeds"</span>, <span class="at">x =</span> <span class="st">"Pitch Speed (mph)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pitch_df, <span class="fu">aes</span>(<span class="at">x =</span> spin_rate)) <span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"darkorange"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Spin Rate"</span>, <span class="at">x =</span> <span class="st">"Spin Rate (rpm)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Nasty Score by Pitch Type</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pitch_df, <span class="fu">aes</span>(<span class="at">x =</span> pitch_type, <span class="at">y =</span> nasty)) <span class="sc">+</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Nasty Score by Pitch Type"</span>, <span class="at">x =</span> <span class="st">"Pitch Type"</span>, <span class="at">y =</span> <span class="st">"Nasty Rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="transformations" class="level2">
<h2 class="anchored" data-anchor-id="transformations">5.2 Transformations</h2>
<p>Here we will create a count category attribute e.g.&nbsp;count: 3-1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>pitch_df<span class="sc">$</span>count_category <span class="ot">&lt;-</span> <span class="fu">paste0</span>(pitch_df<span class="sc">$</span>b_count, <span class="st">"-"</span>, pitch_df<span class="sc">$</span>s_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Convert spin direction into binned compass categories</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define compass bins</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>bin_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"NE"</span>, <span class="st">"E"</span>, <span class="st">"SE"</span>, <span class="st">"S"</span>, <span class="st">"SW"</span>, <span class="st">"W"</span>, <span class="st">"NW"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>pitch_df<span class="sc">$</span>spin_compass <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  pitch_df<span class="sc">$</span>spin_dir,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">360</span>, <span class="at">by =</span> <span class="dv">45</span>),</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> bin_labels,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">right =</span> <span class="cn">FALSE</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create a nasty score category (e.g., low/medium/high nasty) using quantiles</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>pitch_df<span class="sc">$</span>nasty_category <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  pitch_df<span class="sc">$</span>nasty,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">quantile</span>(pitch_df<span class="sc">$</span>nasty, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll approximate time from release to plate using start speed and assume ~60.5 feet of travel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert mph to ft/sec (1 mph = 1.467 ft/s)</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>pitch_df<span class="sc">$</span>start_speed_ft_s <span class="ot">&lt;-</span> pitch_df<span class="sc">$</span>start_speed <span class="sc">*</span> <span class="fl">1.467</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate travel time (seconds)</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>pitch_df<span class="sc">$</span>travel_time <span class="ot">&lt;-</span> <span class="fl">60.5</span> <span class="sc">/</span> pitch_df<span class="sc">$</span>start_speed_ft_s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="more-visualizations-after-transformations" class="level2">
<h2 class="anchored" data-anchor-id="more-visualizations-after-transformations">5.3 More Visualizations After Transformations</h2>
<p><strong>Pitch Distribution by Spin Compass</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pitch_df, <span class="fu">aes</span>(<span class="at">x =</span> spin_compass)) <span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"mediumseagreen"</span>) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Pitches by Spin Compass Direction"</span>, <span class="at">x =</span> <span class="st">"Spin Direction"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pitch_df, <span class="fu">aes</span>(<span class="at">x =</span> count_category, <span class="at">fill =</span> pitch_type)) <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pitch Type Usage by Count"</span>, <span class="at">x =</span> <span class="st">"Count (Balls-Strikes)"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analyzing-MLB-Pitch-Trends_v0407_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>